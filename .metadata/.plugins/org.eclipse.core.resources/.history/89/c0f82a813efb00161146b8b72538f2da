package cn.edu.ccut;

import java.lang.reflect.Proxy;

import org.junit.Test;
import org.springframework.beans.BeansException;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

import cn.edu.ccut.factory.DAOFactory;
import cn.edu.ccut.proxy.Handle;
import cn.edu.ccut.service.IStudentService;
import cn.edu.ccut.service.impl.StudentServiceImpl;
import cn.edu.ccut.vo.Student;

public class SpringTest {
	
	@Test
	public void testUserSave() {
		try {
			ApplicationContext context = new ClassPathXmlApplicationContext("beans.xml");
			IStudentService service = context.getBean("service", StudentServiceImpl.class);
			Student vo = new Student();
			vo.setId(8);
			vo.setName("john");
			vo.setSex("男");
			vo.setAge(24);
			vo.setTel("123456789556");
			vo.setLoc("北京");
			System.out.println(service.insert(vo));
		} catch (BeansException e) {
			System.out.println("sadasdasdas");
			e.printStackTrace();
		}
	}
	
	@Test
	public void testUserSaveProxy() {
		Student vo = new Student();
		IStudentService target = new StudentServiceImpl(DAOFactory.createStudentDAO());
		Handle handle = new Handle(target);
		IStudentService proxy = (IStudentService)Proxy.newProxyInstance(target.getClass().getClassLoader(), target.getClass().getInterfaces(), handle);
		proxy.insert(vo);
	}
	
	@Test
	public void testUserSaveAop() {
		ApplicationContext context = new ClassPathXmlApplicationContext("beans.xml");
		IStudentService service = context.getBean("service", StudentServiceImpl.class);
		Student vo = new Student();
		service.insert(vo);
	}
}